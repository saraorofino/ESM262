---
title: "ESM 262 Assignment 2"
author: "Sara Orofino"
date: "2/26/2020"
output: html_document
---

#{.tabset}

##Load Packages
```{r packages}
library(tidyverse)
```


##Function
 

##Data
Generate the input data for the function  

Inputs:  
 * prices for different fish  
 * number of each fish species caught by location  
 
```{r data, warning=FALSE}
#Create a vector of possible fish
possible_fish <- c("cod", "tuna", "halibut", "salmon", "bass", "grouper", "rockfish")  

#Assign prices for the different fish - let's say prices vary from $3/lb to $30/lb
prices <- runif(length(possible_fish),3,30)

#Create the input table of fish and prices:
fish.prices <- data.frame(fish = possible_fish, price = prices)

#Create a vector of locations:
places <- c("Alaska", "California", "Mexico", "North Carolina", "Maine")

#Create the second input table - number of fish species caught in each location
#I would like to have all the possible fish for every location, start with a list and then cross to get all combinations
catch_list <- list(location = places, fish = possible_fish) %>% cross()

#For each of the combinations draw the catch and then add it to the results list
catch_all <- list() #empty list to store for loop results
for(i in 1:length(catch_list)){
  dat <- as.data.frame(matrix(unlist(catch_list[i]), ncol = 2)) #take the first combination from the list, keep 2 columns
  dat$catch <- rnorm(1,mean=300000,sd=10000) #draw the catch from a normal distribution
  catch_all[[i]] <- dat #save it as a list in the catch_all
}

#Bind all the rows of the lists into one dataframe and update the column names
catch <- bind_rows(catch_all)
colnames(catch) <- c("location", "fish", "catch")

```

##Run Function
```{r run-function}
source("fish_revenue.R")

fish_results <- fish_revenue(fish_data = catch, fish_prices = fish.prices)
```


##Graph Output

Graph of revenue by location and total revenue (text)  